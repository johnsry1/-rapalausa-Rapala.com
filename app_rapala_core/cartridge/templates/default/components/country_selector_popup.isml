<!--- TEMPLATENAME: session_warn_popup.isml --->
<isinclude template="util/modules"/>
<isscript>
	var currentCountry = require('app_rapala_core/cartridge/scripts/util/Countries').getCurrent(pdict).countryCode.toLowerCase();
	var currentSite = dw.system.Site.getCurrent();
	var internationalBrandLink = dw.object.CustomObjectMgr.queryCustomObjects("BrandCountryLinks", "custom.brand = {0} AND custom.countryDisplayName ilike 'international*'", "custom.sequenceNumber asc", session.custom.currentSite).next();
	var usLink=URLUtils.url('Home-SetLocale', 'locale', 'default');
	var caLink=dw.object.CustomObjectMgr.getCustomObject("BrandCountryLinks", "Rapala - Canada").custom.url;
	var euLink='/eu-en';
	
	if (currentSite.ID == 'rapalaEU') {
		currentCountry = 'eu';
		var usLink=usLink.toString().replace('rapalaEU', 'rapala');
	}
	
	if (session.custom.hasOwnProperty('countrySelectorPid')) {
		let productID = session.custom.countrySelectorPid;
		var usLink=URLUtils.url('Product-ShowInLocale', 'pid', productID).toString().replace('rapalaEU', 'rapala');
		var euLink=URLUtils.url('Product-ShowInLocale', 'pid', productID).toString().replace('rapala', 'rapalaEU');
	} else if (session.custom.hasOwnProperty('countrySelectorCgid')) {
		let cgid = session.custom.countrySelectorCgid;
		var usLink=URLUtils.url('Search-ShowInLocale', 'cgid', cgid).toString().replace('rapalaEU', 'rapala');
		var euLink=URLUtils.url('Search-ShowInLocale', 'cgid', cgid).toString().replace('rapala', 'rapalaEU');
	} else if (session.custom.hasOwnProperty('countrySelectorCid')) {
		let cid = session.custom.countrySelectorCid;
		var usLink=URLUtils.url('Page-ShowInLocale', 'cid', cid).toString().replace('rapalaEU', 'rapala');
		var euLink=URLUtils.url('Page-ShowInLocale', 'cid', cid).toString().replace('rapala', 'rapalaEU');
	}

	session.custom.showCountryPopup = false;
</isscript>

<div id="country-selector-popup">
	<div class="country-select-header">${Resource.msg('global.selectcountry', 'locale', null)}</div>
	<div class="current-country">
		<span>${Resource.msg('global.currentlyviewing', 'locale', null)}</span>
		<div class="current-flag-container">
			<img src="${URLUtils.staticURL('/lib/flag-icon-css/flags/1x1/' +currentCountry+ '.svg')}" alt="${currentCountry}">
		</div>
	</div>
	<div class="countries-container">
		<div class="row first">
			<a class="country" href="${caLink}">
				<div class="flag-container">
					<img class="flag" src="${URLUtils.staticURL('/lib/flag-icon-css/flags/1x1/ca.svg')}" alt="${'ca'}">
				</div>
				<div class="url-container">
					<div class="rapala-iternational-cart"></div>
					<div class="url">${Resource.msg('global.caurl', 'locale', null)}</div>
				</div>
			</a>
			<div class="divider"></div>
			<a class="country" href="${euLink}">
				<div class="flag-container">
					<img class="flag" src="${URLUtils.staticURL('/lib/flag-icon-css/flags/1x1/eu.svg')}" alt="${'ca'}">
				</div>
				<div class="url-container">
					<div class="rapala-iternational-cart"></div>
					<div class="url">${Resource.msg('global.euurl', 'locale', null)}</div>
				</div>
			</a>
		</div>
		<div class="row second">
			<a class="country" href="${usLink}">
				<div class="flag-container">
					<img class="flag" src="${URLUtils.staticURL('/lib/flag-icon-css/flags/1x1/us.svg')}" alt="${'ca'}">
				</div>
				<div class="url-container">
					<div class="rapala-iternational-cart"></div>
					<div class="url">${Resource.msg('global.usurl', 'locale', null)}</div>
				</div>
			</a>
		</div>
	</div>
	<div class="checking">
		${Resource.msg('global.checkingcountry', 'locale', null)}
	</div>
	<a class="gray-button" href="${euLink}">${Resource.msg('global.internationalsite', 'locale', null)}</a>
	<a class="gray-button" href="${URLUtils.url('Home-ChangeRegion').toString().replace('rapala-', 'rapalaEU-')}">${Resource.msg('global.localdistributor', 'locale', null)}</a>

</div>